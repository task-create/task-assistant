<!doctype html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Employment Assistant</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@700;800&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet"/>

  <style>
    :root{
      --brand:#6aa4ff; --accent:#1f6dcb;
      --bg:#0a0f1a; --surface:#111929; --surface-2:#0e1625;
      --text:#eaf2ff; --muted:#a7bad5; --border:#344b6b;
      --bubble-bot-bg:#1e293b; --bubble-bot-text:#eaf2ff;
      --bubble-user-bg:#1f6dcb; --bubble-user-text:#fff;
      --shadow:0 10px 24px rgba(0,0,0,.35);
    }
    [data-theme="light"]{
      --bg:#f4f7fa; --surface:#fff; --surface-2:#f7fbff;
      --text:#242424; --muted:#6b6b6b; --border:#d9dad9;
      --bubble-bot-bg:#fff; --bubble-bot-text:#242424;
      --bubble-user-bg:#6aa4ff; --bubble-user-text:#fff;
    }
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0; background:var(--bg); color:var(--text);
         font-family:"Open Sans",system-ui,Segoe UI,Roboto,Arial; line-height:1.45}

    /* Layout */
    .main-container{max-width:600px;margin:0 auto;height:100vh;display:flex;flex-direction:column;
      background:var(--surface); border:1px solid var(--border); border-radius:18px; box-shadow:var(--shadow); overflow:hidden}
    .header{padding:10px 14px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;background:var(--surface)}
    .header-title{font:800 1.2rem/1 "Nunito",sans-serif;color:var(--accent)}
    .header-actions{display:flex;gap:6px}
    .icon-btn{width:38px;height:38px;border-radius:10px;border:1px solid var(--border);background:var(--surface-2);color:var(--text);cursor:pointer}
    .icon-btn:hover{background:var(--accent);border-color:var(--accent);color:#fff}

    #chat{flex:1;overflow:auto;padding:16px;background:var(--surface-2)}
    .bubble-wrapper{margin:12px 0;display:flex;gap:10px}
    .bubble{max-width:88%;padding:12px 14px;border-radius:16px;box-shadow:var(--shadow);font-size:.95rem}
    .bubble.bot{background:var(--bubble-bot-bg);color:var(--bubble-bot-text);border:1px solid var(--border);border-radius:16px 16px 16px 8px}
    .bubble.user{background:var(--bubble-user-bg);color:var(--bubble-user-text);margin-left:auto;border-radius:16px 16px 8px 16px}
    .avatar{width:28px;height:28px;border-radius:50%;background:var(--accent);color:#fff;display:grid;place-items:center;font:700 .85rem "Nunito",sans-serif}

    .inputbar{display:flex;gap:8px;padding:10px;border-top:1px solid var(--border);background:var(--surface)}
    #box{flex:1;border:1px solid var(--border);background:var(--surface-2);color:var(--text);border-radius:999px;padding:12px 14px}
    #send{width:48px;height:48px;border-radius:50%;background:var(--brand);color:#fff;border:0;cursor:pointer}
    #send:hover{background:var(--accent)}

    .status{padding:8px 12px;text-align:center;font-size:.8rem;color:var(--muted);background:var(--surface-2)}
    .legal{font-size:.75rem;color:var(--muted);text-align:center;padding:6px}

    /* Splash */
    #splash-screen{position:fixed;inset:0;background:var(--accent);color:#fff;display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:9999;transition:opacity .4s}
    .splash-button{background:#fff;color:var(--accent);border:0;border-radius:999px;padding:12px 22px;font:800 1rem "Nunito",sans-serif;cursor:pointer}
    .splash-button:hover{opacity:.9}

    /* Tools overlay */
    #tools-overlay{display:none;position:fixed;inset:0;z-index:9998;background:rgba(0,0,0,.45);backdrop-filter:blur(6px)}
    .tools-panel{width:min(980px,94vw);height:min(82vh,720px);background:var(--surface);border:1px solid var(--border);border-radius:18px;box-shadow:var(--shadow);display:flex;flex-direction:column}
    .tools-head{display:flex;align-items:center;justify-content:space-between;padding:.75rem 1rem;border-bottom:1px solid var(--border)}
    .tools-grid{display:grid;grid-template-columns:260px 1fr;min-height:0;flex:1}
    .tools-tabs{border-right:1px solid var(--border);padding:.5rem;overflow:auto}
    .tools-body{padding:1rem;overflow:auto}
    .tool-tab{display:block;width:100%;text-align:left;padding:.5rem;border-radius:10px;margin:.15rem 0;border:1px solid var(--border);background:var(--surface-2);color:var(--text)}
    .tool-tab.active{background:var(--accent);border-color:var(--accent);color:#fff}
  </style>
</head>
<body>

<!-- Splash (no logo; click calls startApp()) -->
<div id="splash-screen">
  <h1 style="font:800 1.8rem 'Nunito',sans-serif;margin:.2rem 0">Welcome to the Employment Assistant</h1>
  <p style="opacity:.95;margin:0 0 .9rem">Your guide to jobs, training, and resources in the Greater Trenton Area.</p>
  <button class="splash-button" onclick="startApp()">Start</button>
  <div class="legal" style="color:#fff">Tip: keep your proxy running (http://localhost:3000)</div>
</div>

<!-- App -->
<main class="main-container" id="app" style="display:flex">
  <header class="header">
    <div class="header-title">Employment Assistant</div>
    <div class="header-actions">
      <button class="icon-btn" id="resetBtn" title="Clear chat">‚Ü∫</button>
      <button class="icon-btn" id="themeToggle" title="Theme">üåó</button>
      <button class="icon-btn" id="magicBtn" title="Tools">‚ú®</button>
    </div>
  </header>

  <section id="chat" role="log" aria-live="polite" aria-relevant="additions" aria-label="Chat transcript"></section>
  <div id="status" class="status">‚ö†Ô∏è I can make mistakes ‚Äî please double-check important info.</div>

  <div class="inputbar">
    <input id="box" type="text" placeholder="Type your message‚Ä¶" autocomplete="off"/>
    <button id="send" aria-label="Send">‚û°Ô∏è</button>
  </div>

  <div class="legal">Disclaimer: This assistant is for information only and not legal/financial advice.</div>
</main>

<!-- Tools overlay -->
<div id="tools-overlay">
  <div style="position:absolute;inset:0;display:flex;align-items:center;justify-content:center;">
    <div class="tools-panel">
      <div class="tools-head">
        <strong>Assistant Tools</strong>
        <div>
          <button id="runTool" class="splash-button" style="margin-right:8px">Run</button>
          <button id="closeToolsBtn" class="icon-btn" title="Close">‚úñ</button>
        </div>
      </div>
      <div class="tools-grid">
        <aside id="tools-tabs" class="tools-tabs"></aside>
        <section id="tools-body" class="tools-body"></section>
      </div>
    </div>
  </div>
</div>
<script>
'use strict';

/* ===== CONFIG ===== */
const CONFIG = {
  API_BASE: "http://localhost:3000/gen",   // your Node proxy
  MODEL: "gemini-1.5-flash",

  APPOINTMENT_NUMBER: '609-337-1624',
  DIANI_NUMBER: '609-697-6166',
  SEAN_NUMBER: '609-697-6215',
  TASK_ADDRESS: '72 1/2 Escher Street, Trenton, NJ 08609',
  TASK_WEBSITE: 'https://www.trentonsoupkitchen.org',
  TRAINING_APPLY_LINK: 'https://bycell.mobi/wap/default/item.jsp?entryid=ECNDE0Mg==&itemid=170659',
  SORA_LINK: 'https://www.njsp.org/private-detective/sora.shtml',
  CAREER_TIPS_LINK: 'https://bycell.co/ddmnx',
  NJ_TRANSIT_TRIP_PLANNER: 'https://www.njtransit.com/bus-to',
  GOOGLE_JOBS_BASE: 'https://www.google.com/search?q=entry+level+jobs+in+Mercer+County+NJ&ibp=htl;jobs'
};

const el = id => document.getElementById(id);
const chat = el('chat'), box = el('box'), sendBtn = el('send'), statusDiv = el('status');

let chatHistory = [];
let lang = 'en';

/* ===== UI helpers ===== */
function addU(html){
  const w = document.createElement('div');
  w.className = 'bubble-wrapper';
  w.innerHTML = `<div class="bubble user">${html}</div>`;
  chat.appendChild(w); chat.scrollTop = chat.scrollHeight;
}
function addB(html){
  const w = document.createElement('div');
  w.className = 'bubble-wrapper';
  w.innerHTML = `<div class="avatar">E</div><div class="bubble bot">${html}</div>`;
  chat.appendChild(w); chat.scrollTop = chat.scrollHeight;
}

let typingDiv=null;
function typing(on){
  if(on){
    typingDiv = document.createElement('div');
    typingDiv.className='bubble-wrapper';
    typingDiv.innerHTML = `<div class="avatar">E</div><div class="bubble bot">‚Ä¶</div>`;
    chat.appendChild(typingDiv); chat.scrollTop = chat.scrollHeight;
  } else if(typingDiv){ typingDiv.remove(); typingDiv=null; }
}

function setLang(l){ lang = (['en','es','ht'].includes(l)?l:'en'); try{localStorage.setItem('task_lang',lang)}catch{} }
function initTheme(){
  let saved=null; try{ saved = localStorage.getItem('task_theme'); }catch{}
  const dark = saved ? saved==='dark' : matchMedia('(prefers-color-scheme: dark)').matches;
  document.documentElement.setAttribute('data-theme', dark?'dark':'light');
}
el('themeToggle').addEventListener('click',()=>{
  const dark = document.documentElement.getAttribute('data-theme')==='dark';
  const next = dark ? 'light' : 'dark';
  document.documentElement.setAttribute('data-theme', next);
  try{ localStorage.setItem('task_theme', next); }catch{}
});

/* ===== Splash start ===== */
function startApp(){
  const s = el('splash-screen'); if(s){ s.style.opacity='0'; setTimeout(()=>s.style.display='none', 400); }
  greet();
}

/* ===== Greet ===== */
function greet(){
  const saved = (()=>{try{return localStorage.getItem('task_lang')}catch{return null}})();
  setLang(saved||'en');
  addB(`<div class="card-base"><h3>Welcome!</h3><p>Ask me about jobs, resumes, interviews, or open the Tools (‚ú®).</p></div>`);
}

/* ===== Language detection (simple) ===== */
async function detectAndSetLanguage(promptText){
  try{
    const payload = {
      model: CONFIG.MODEL,
      contents: [{role:'user', parts:[{text:`Detect the language of this message. Reply ONLY with "en", "es", or "ht": ${promptText}` }]}]
    };
    const r = await fetch(CONFIG.API_BASE,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});
    const j = await r.json(); const t = j?.candidates?.[0]?.content?.parts?.map(p=>p.text).join('').trim().toLowerCase();
    if(['en','es','ht'].includes(t) && t!==lang) setLang(t);
  }catch{}
}
/* ===== System prompt + Gemini call via proxy ===== */
function systemPrompt(currentLang){
  return `
You are the Employment Assistant for TASK. Be warm and practical.
- ALWAYS reply in ${currentLang}.
- Prefer short bullet lists for steps.
- If user asks for jobs and provides a type/company, reply ONLY with [SEARCH_JOBS: value].
- If user asks for address/location, reply ONLY with [TASK_ADDRESS].
- Use CAR (Challenge, Action, Result) for resume bullets.
`;
}

async function getAiResponse(userText){
  const payload = {
    model: CONFIG.MODEL,
    contents: [
      { role:'user', parts:[{ text: systemPrompt(lang) }] },
      ...chatHistory.map(m=>({role:m.role==='user'?'user':'model', parts:[{text:m.parts?.[0]?.text||m.text}]})),
      { role:'user', parts:[{ text: userText }] }
    ],
    tools: [{ google_search_retrieval: {} }]
  };
  const doFetch = async (tries=0)=>{
    const r = await fetch(CONFIG.API_BASE,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});
    if((r.status===429||r.status>=500) && tries<3){ await new Promise(res=>setTimeout(res, 800*(2**tries))); return doFetch(tries+1); }
    if(!r.ok) throw new Error(`Proxy error ${r.status}`);
    return r.json();
  };
  const data = await doFetch(0);
  const text = data?.candidates?.[0]?.content?.parts?.map(p=>p.text).join('\n') || '‚ö†Ô∏è Empty response';
  chatHistory.push({role:'model', parts:[{text}]});
  return text;
}

/* ===== Jobs & helpers ===== */
function googleJobsCard(q){
  const url = `https://www.google.com/search?q=${encodeURIComponent(q)}&ibp=htl;jobs`;
  return `
    <div class="bubble bot" style="background:var(--surface);border:1px solid var(--border);">
      <strong>Live job search:</strong> ${q}<br/>
      <a href="${url}" target="_blank" rel="noopener">Open Google Jobs safely</a>
    </div>`;
}

async function handle(input){
  if(!input) return;
  addU(input); typing(true);
  await detectAndSetLanguage(input);
  try{
    const out = await getAiResponse(input);
    if(out.startsWith('[SEARCH_JOBS:')){
      const m = out.match(/\[SEARCH_JOBS:\s*(.+?)\s*\]/);
      typing(false);
      if(m){ const html = googleJobsCard(m[1]); addB(html); } else { addB('Sorry, I could not parse the job search.'); }
      return;
    }
    if(out.startsWith('[TASK_ADDRESS]')){
      typing(false);
      addB(`<div class="bubble bot">Address: <a target="_blank" rel="noopener" href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(CONFIG.TASK_ADDRESS)}">${CONFIG.TASK_ADDRESS}</a></div>`);
      return;
    }
    typing(false); addB(out);
  }catch(e){
    typing(false); addB('Error: '+(e?.message||e));
  }
}

function send(){ const t=(box.value||'').trim(); if(!t) return; box.value=''; handle(t); }
sendBtn.addEventListener('click', send);
box.addEventListener('keydown', e=>{ if(e.key==='Enter'){ e.preventDefault(); send(); } });

el('resetBtn').addEventListener('click', ()=>{ chat.innerHTML=''; chatHistory=[]; greet(); });
el('magicBtn').addEventListener('click', ()=>{ showToolsOverlay(); });

/* Init */
initTheme();
</script>
<script>
/* ===== 23 specialized tools ===== */
const ADV_TOOLS = [
  // Resume & Application
  {id:'job_simplifier',name:'Job Simplifier',f:[{id:'job',label:'Paste job description',t:'textarea'}],t:`Simplify this job post for a beginner. List 5 key duties and 5 must-have skills:\n\n{{job}}`},
  {id:'keyword_checker',name:'Keyword Checker',f:[{id:'resume',label:'Paste resume',t:'textarea'},{id:'target',label:'Target job title',t:'text'}],t:`Extract missing keywords for a {{target}} resume. Two lists: High-priority & Nice-to-have.\n\nResume:\n{{resume}}`},
  {id:'cover_letter',name:'Cover Letter Drafter',f:[{id:'resume',label:'Resume',t:'textarea'},{id:'job',label:'Job post',t:'textarea'}],t:`Draft a concise cover letter (<=180 words) using the resume and job.\n\nResume:\n{{resume}}\n\nJob:\n{{job}}`},
  {id:'follow_up',name:'Follow-up Email Drafter',f:[{id:'role',label:'Role',t:'text'},{id:'interviewer',label:'Interviewer (optional)',t:'text'}],t:`Write a friendly interview thank-you email for the {{role}} role addressed to {{interviewer||"the hiring team"}}.`},
  {id:'resume_score',name:'Resume Feedback & Scoring',f:[{id:'resume',label:'Resume',t:'textarea'},{id:'job',label:'Job post',t:'textarea'}],t:`Score this resume 0-100 vs the job and list 5 fixes.\n\nResume:\n{{resume}}\n\nJob:\n{{job}}`},

  // Interview & Negotiation
  {id:'interview_coach',name:'Interview Coach',f:[{id:'job',label:'Job post',t:'textarea'}],t:`Generate 8 interview questions + one-line model answers based on this job:\n\n{{job}}`},
  {id:'negotiation',name:'Negotiation Planner',f:[{id:'offer',label:'Offer details',t:'textarea'}],t:`Create talking points to negotiate this offer, with a polite script + fallback options:\n\n{{offer}}`},

  // Job Search & Planning
  {id:'career_path',name:'Career Path Finder',f:[{id:'interests',label:'Interests/experience',t:'textarea'}],t:`Suggest 3 entry-level career paths matching: {{interests}}. For each, list starting roles, pay range, and first steps.`},
  {id:'search_plan',name:'Search Strategy Planner',f:[{id:'days',label:'Days to plan (e.g., 7)',t:'text'}],t:`Create a {{days}}-day job search plan with daily tasks under 45 minutes.`},
  {id:'skill_gap',name:'Skill Gap Analyzer',f:[{id:'target',label:'Target job',t:'text'},{id:'resume',label:'Resume',t:'textarea'}],t:`Compare this resume to a typical {{target}} role. List missing skills and 3 free resources for each.\n\nResume:\n{{resume}}`},
  {id:'task_prioritizer',name:'Search Task Prioritizer',f:[{id:'context',label:'What are you working on?',t:'textarea'}],t:`Given this context, list the top 3 tasks to do today for job search focus:\n\n{{context}}`},
  {id:'transit',name:'Public Transit Route Planner',f:[{id:'from',label:'From',t:'text'},{id:'to',label:'To',t:'text'}],t:`Give step-by-step transit directions from "{{from}}" to "{{to}}". Include total time, fare estimate, and transfer notes.`},

  // Support & Resource
  {id:'local_resources',name:'Local Resource Finder (Mercer County)',f:[{id:'need',label:'What do you need?',t:'text'}],t:`List 5 organizations in Mercer County, NJ that help with "{{need}}". Give phone, website, and what they do.`},
  {id:'doc_explainer',name:'Document Explainer',f:[{id:'doc',label:'Paste document text',t:'textarea'}],t:`Explain the purpose of this document and 3‚Äì5 key actions:\n\n{{doc}}`},
  {id:'benefits',name:'Benefits Explainer',f:[{id:'benefits',label:'Benefits to explain',t:'text'}],t:`Explain these benefits in plain English with pros/cons and when they matter: {{benefits}}`},
  {id:'rights',name:'Workplace Rights Explainer',f:[{id:'topic',label:'Topic (FMLA, PTO, etc.)',t:'text'}],t:`Explain {{topic}} in simple terms. Include eligibility, pitfalls, and one talk-track for HR.`},

  // Digital Literacy & Safety
  {id:'scam',name:'Scam & Fraud Checker',f:[{id:'text',label:'Paste message or job',t:'textarea'}],t:`Is this a job scam? List red flags and a safe next step.\n\n{{text}}`},
  {id:'form_helper',name:'Digital Form Assistant',f:[{id:'question',label:'Confusing question',t:'textarea'}],t:`Explain how to answer this application question. Provide 2 example answers (good/better):\n\n{{question}}`},
  {id:'digital_coach',name:'Basic Digital Skill Coach',f:[{id:'task',label:'What do you want to do?',t:'text'}],t:`Give step-by-step directions for: "{{task}}". Keep each step short.`},
  {id:'app_troubleshooter',name:'App Troubleshooter',f:[{id:'app',label:'App name',t:'text'},{id:'issue',label:'Issue',t:'textarea'}],t:`Troubleshoot the {{app}} problem: {{issue}}. Give 5 fixes (fastest first).`},

  // Personal & Financial
  {id:'budget',name:'Financial Goal Planner',f:[{id:'income',label:'Monthly take-home',t:'text'},{id:'bills',label:'Big bills',t:'textarea'}],t:`Create a simple 50/30/20 budget from income "{{income}}" and these bills:\n\n{{bills}}`},
  {id:'support',name:'Emotional Support Check-In',f:[{id:'feel',label:'How are you feeling?',t:'text'}],t:`Respond with empathy to "{{feel}}", then list 4 grounding steps.`},

  // Specialized Skill
  {id:'food_service',name:'Food Service Skill Translator',f:[{id:'tasks',label:'What did you do on the job?',t:'textarea'}],t:`Turn these food-service tasks into 6 resume bullets with action verbs and metrics:\n\n{{tasks}}`}
];

function showToolsOverlay(){ renderToolsPanel(); el('tools-overlay').style.display='block'; }
function closeToolsOverlay(){ el('tools-overlay').style.display='none'; }

function renderToolsPanel(){
  const tabsHTML = ADV_TOOLS.map(t=>`<button class="tool-tab" data-id="${t.id}">${t.name}</button>`).join('');
  el('tools-tabs').innerHTML = tabsHTML;
  buildToolForm(ADV_TOOLS[0].id);
  [...document.querySelectorAll('.tool-tab')].forEach(btn=>{
    btn.onclick=()=>{ [...document.querySelectorAll('.tool-tab')].forEach(x=>x.classList.remove('active')); btn.classList.add('active'); buildToolForm(btn.dataset.id); };
  });
  // mark first active
  const first = document.querySelector('.tool-tab'); if(first) first.classList.add('active');
}

function buildToolForm(id){
  const t = ADV_TOOLS.find(x=>x.id===id); el('tools-overlay').dataset.active=id;
  const fields = t.f.map(f=>{
    const base = `style="width:100%;padding:10px 12px;border:1px solid var(--border);border-radius:12px;background:var(--surface-2);color:var(--text)"`
    return `<label style="display:block;font-weight:700;margin:.5rem 0 .25rem">${f.label}</label>` +
      (f.t==='textarea' ? `<textarea id="${f.id}" rows="6" ${base}></textarea>` : `<input id="${f.id}" type="${f.t||'text'}" ${base}/>` );
  }).join('');
  el('tools-body').innerHTML = `<form id="tool-form">${fields}</form>`;
}

function fillTemplate(tpl, values){
  return tpl.replace(/{{\s*([^}|]+)(?:\|\|\s*"([^"]*)")?\s*}}/g,(_,k,fb)=>{const v=(values[k]??'').toString().trim();return v?v:(fb??'');});
}

el('closeToolsBtn').addEventListener('click', closeToolsOverlay);
el('runTool').addEventListener('click', ()=>{
  const id = el('tools-overlay').dataset.active;
  const t = ADV_TOOLS.find(x=>x.id===id);
  const vals = Object.fromEntries(t.f.map(f=>[f.id,(el(f.id)?.value||'')]));
  const prompt = fillTemplate(t.t, vals);
  closeToolsOverlay();
  handle(prompt);
});
</script>

</body>
</html>
// server.js - Local Gemini proxy with permissive CORS
const express = require('express');
require('dotenv').config();

let fetchImpl;
try { fetchImpl = require('node-fetch'); } catch { fetchImpl = global.fetch; }
const fetch = (...a)=> (fetchImpl ? fetchImpl(...a) : global.fetch(...a));

const app = express();
app.use(express.json());

// CORS (allow file:// and any origin during local dev)
app.use((req,res,next)=>{
  res.setHeader('Access-Control-Allow-Origin','*');
  res.setHeader('Access-Control-Allow-Methods','POST,GET,OPTIONS');
  res.setHeader('Access-Control-Allow-Headers','content-type');
  if(req.method==='OPTIONS') return res.end();
  next();
});

app.get('/health', (req,res)=> res.json({ok:true}));

app.post('/gen', async (req,res)=>{
  try{
    const key = process.env.GEMINI_API_KEY;
    if(!key) return res.status(500).json({error:'GEMINI_API_KEY not set'});

    const model = (req.body && req.body.model) || 'gemini-1.5-flash';
    const url = `https://generativelanguage.googleapis.com/v1beta/models/${encodeURIComponent(model)}:generateContent?key=${encodeURIComponent(key)}`;

    const upstream = await fetch(url, {
      method:'POST',
      headers:{'content-type':'application/json'},
      body: JSON.stringify(req.body || {})
    });

    res.status(upstream.status);
    if(upstream.body && upstream.body.pipe){
      upstream.body.pipe(res);
    }else{
      const data = await upstream.json().catch(()=>({}));
      res.json(data);
    }
  }catch(e){
    console.error('Proxy error:', e);
    res.status(500).json({error:String(e?.message||e)});
  }
});

const PORT = process.env.PORT || 3000;
app.listen(PORT, ()=> console.log(`Proxy listening on http://localhost:${PORT}`));
{
  "name": "gemini-proxy",
  "version": "1.0.0",
  "private": true,
  "type": "commonjs",
  "main": "server.js",
  "scripts": {
    "start": "node server.js"
  },
  "dependencies": {
    "dotenv": "^17.2.3",
    "express": "^5.1.0",
    "node-fetch": "^2.7.0"
  }
}
AIzaSyCqvaS8KAhY-Al6P5F8JvyJ6n5_VdXae_s
PORT=3000
