<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>TASK Assistant</title>

  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@600;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet"/>

  <style>
    /* ---------- Design tokens ---------- */
    :root{
      --radius: 18px;

      /* Light theme */
      --bg: #eef3f8;
      --surface: #ffffff;
      --surface-2: #f7fbff;
      --text: #0e1726;
      --muted: #5f6c80;
      --chip: #ffffff;
      --chip-border: #ffd9b0;
      --border: #d9e2ec;
      --accent: #ff911f;
      --accent-2: #ffc91f;
      --brand: #145078;
      --link: #0b63c6;
      --shadow: 0 20px 40px rgba(20,80,120,.22);
      --shadow-soft: 0 8px 24px rgba(19, 33, 58, .12);

      /* bot bubble */
      --bubble-bot: #ffffff;
      --bubble-border: #d9e2ec;

      /* user bubble (light) */
      --bubble-user-bg: linear-gradient(135deg,var(--accent),var(--accent-2));
      --bubble-user-text: #fff;
      --bubble-user-border: transparent;

      /* typing dots */
      --typing-dot: #7e8aa3;
    }

    /* Sleek ChatGPT-ish dark mode */
    [data-theme="dark"]{
      --bg: #0b1220;           /* page */
      --surface: #0f1726;      /* content slab */
      --surface-2: #0d1522;    /* rail/footer */
      --text: #e6edf7;
      --muted: #a7b6c9;
      --chip: #0f1926;
      --chip-border: #2b3a4e;
      --border: #223247;
      --accent: #ffb357;
      --accent-2: #ffd36a;
      --brand: #8bd0ff;
      --link: #87c4ff;
      --shadow: 0 18px 36px rgba(0,0,0,.45);
      --shadow-soft: 0 6px 18px rgba(0,0,0,.35);

      /* bot bubble (dark) */
      --bubble-bot: #121e33;
      --bubble-border: #2a3b55;

      /* user bubble like your image (solid blue + crisp border) */
      --bubble-user-bg: #1f86ff;
      --bubble-user-text: #ffffff;
      --bubble-user-border: #0f5fc3;

      /* typing dots (bright for dark bg) */
      --typing-dot: #a9c7ff;
    }

    *{box-sizing:border-box;margin:0;padding:0}
    body{
      font-family:"Open Sans",system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      background:var(--bg);
      min-height:100vh;display:flex;align-items:center;justify-content:center;padding:14px;
    }
    a{color:var(--link);text-decoration:none}
    a:hover{text-decoration:underline}

    .app{
      width:100%;max-width:420px;background:var(--surface);
      border:3px solid var(--accent);border-radius:var(--radius);overflow:hidden;
      box-shadow:var(--shadow);
    }
    /* -------- Header -------- */
    .header{
      background:var(--surface-2);
      border-bottom:1px solid var(--border);
      display:flex;align-items:center;justify-content:center;
      padding:10px 12px; position:relative;
    }
    .badge{
      display:inline-block;background:var(--brand);color:#fff;
      padding:8px 14px;border-radius:999px;font:700 13px/1 "Nunito",sans-serif;letter-spacing:.2px;
      box-shadow:var(--shadow-soft); text-align:center;
    }
    .theme{
      position:absolute;right:10px;top:10px;border:none;border-radius:999px;
      width:30px;height:30px;cursor:pointer;background:linear-gradient(135deg,var(--accent),var(--accent-2));
      color:#222;display:flex;align-items:center;justify-content:center;font-weight:700;
      box-shadow:var(--shadow-soft);
    }

    /* -------- Top link rail -------- */
    .rail{
      display:flex;gap:12px;flex-wrap:wrap;justify-content:center;
      padding:12px;background:var(--surface-2);border-bottom:1px solid var(--border);
    }
    .chip{
      display:inline-flex;align-items:center;gap:8px;
      font-weight:600;font-size:12px;color:var(--brand);
      border:1px solid var(--chip-border);background:var(--chip);border-radius:999px;
      padding:8px 12px;box-shadow:var(--shadow-soft);
    }
    .chip i{opacity:.75}

    /* -------- Chat area -------- */
    .chat{
      height:420px;overflow:auto;padding:14px;scroll-behavior:smooth;
      background:
        radial-gradient(70% 100% at -10% -20%, rgba(255,255,255,.06) 0%, rgba(255,255,255,0) 65%),
        radial-gradient(60% 90% at 110% 120%, rgba(255,255,255,.04) 0%, rgba(255,255,255,0) 60%),
        linear-gradient(180deg, var(--surface) 0%, var(--surface-2) 100%);
    }

    /* -------- Bubbles -------- */
    .bubble{
      margin:12px 0;padding:12px 16px;border-radius:16px;font-size:13px;line-height:1.45;
      border:1px solid var(--bubble-border);
      background:var(--bubble-bot);color:var(--text);
      box-shadow:var(--shadow-soft);
    }
    .bubble.bot{margin-right:20%;}

    /* USER bubble â€” orange gradient in light, blue + tail in dark */
    .bubble.user{
      position:relative;
      margin-left:20%;text-align:right;
      color:var(--bubble-user-text);
      background:var(--bubble-user-bg);
      border:1px solid var(--bubble-user-border);
      border-radius:16px 16px 4px 16px;
      box-shadow:var(--shadow-soft);
    }

    /* Clean, pointed tail with visible border (dark mode only) */
    [data-theme="dark"] .bubble.user::after,        /* border layer */
    [data-theme="dark"] .bubble.user::before{       /* fill layer  */
      content:""; position:absolute; bottom:16px;
      width:16px; height:14px; right:-11px;
      clip-path: polygon(100% 50%, 0 0, 0 100%); /* â–º small right-pointing triangle */
    }
    [data-theme="dark"] .bubble.user::after{        /* border */
      background:var(--bubble-user-border);
    }
    [data-theme="dark"] .bubble.user::before{       /* fill, slightly inset to show border */
      right:-9px; bottom:17px; width:14px; height:12px;
      background:var(--bubble-user-bg);
    }

    .note{font-size:11px;color:var(--muted)}

    /* -------- Typing indicator (three bouncing dots) -------- */
    .typing{ display:inline-flex; gap:6px; align-items:flex-end; }
    .typing .dot{
      width:6px;height:6px;border-radius:50%;
      background:var(--typing-dot);
      animation:bounce 1s infinite ease-in-out;
      will-change: transform, opacity;
    }
    .typing .dot:nth-child(2){ animation-delay:.12s }
    .typing .dot:nth-child(3){ animation-delay:.24s }

    @keyframes bounce{
      0%, 80%, 100%{ transform:translateY(0); opacity:.6 }
      40%{ transform:translateY(-6px); opacity:1 }
    }

    /* -------- Input area -------- */
    .footer{padding:12px;background:var(--surface-2);border-top:1px solid var(--border)}
    .hint{
      font-size:11px;color:var(--brand);
      background:linear-gradient(135deg,rgba(116,186,88,.12),rgba(51,167,181,.10));
      border:1px solid var(--border);border-radius:12px;padding:8px 10px;text-align:center;font-weight:600;margin-bottom:10px
    }
    .row{display:flex;gap:10px;align-items:center}
    input[type="text"]{
      flex:1;padding:14px 16px;border:2px solid var(--border);
      border-radius:25px;font-size:14px;outline:none;background:var(--surface);
      color:var(--text); caret-color:var(--accent);
      box-shadow: inset 0 1px 2px rgba(0,0,0,.06);
    }
    input[type="text"]::placeholder{color:var(--muted)}
    input[type="text"]:focus{border-color:var(--accent)}
    .send{
      width:50px;height:50px;border:none;border-radius:50%;cursor:pointer;color:#222;font-size:18px;
      background:linear-gradient(135deg,var(--accent),var(--accent-2));box-shadow:var(--shadow-soft)
    }
    .status{margin-top:6px;text-align:center;font-size:10px;color:var(--muted)}
  </style>
</head>
<body>
  <main class="app" id="app">
    <header class="header">
      <div class="badge">TASK Assistant</div>
      <button id="themeToggle" class="theme" title="Toggle theme">â˜¼</button>
    </header>

    <!-- Top rail: open links only -->
    <nav class="rail" id="top-rail">
      <a class="chip" href="https://www.google.com/maps?q=72+1/2+Escher+St,+Trenton,+NJ+08609" target="_blank" rel="noopener"><i>ğŸ“</i>Address</a>
      <a class="chip" href="https://bycell.co/ddmtq" target="_blank" rel="noopener"><i>ğŸ’¼</i>Jobs</a>
      <a class="chip" href="https://bycell.co/ddmtr" target="_blank" rel="noopener"><i>ğŸ””</i>Alerts</a>
      <a class="chip" href="https://bycell.co/ddmtn" target="_blank" rel="noopener"><i>ğŸ“</i>Training</a>
      <a class="chip" href="https://bycell.co/ddmui" target="_blank" rel="noopener"><i>ğŸ“„</i>Resume</a>
      <a class="chip" href="https://www.youtube.com/watch?v=ZU9x1vFx5lI" target="_blank" rel="noopener"><i>ğŸ¥</i>Interview Tips</a>
      <a class="chip" href="https://bycell.co/ddmua" target="_blank" rel="noopener"><i>ğŸ§°</i>Resources</a>
    </nav>

    <section class="chat" id="chat"></section>

    <footer class="footer">
      <div class="hint" id="langHint">I speak English, EspaÃ±ol & KreyÃ²l</div>
      <div class="row">
        <input id="box" type="text" placeholder="Type keywords: training, jobs, hours, address, busâ€¦" autocomplete="off"/>
        <button class="send" id="send" aria-label="Send">â¤</button>
      </div>
      <div class="status" id="status">âš ï¸ I can make mistakes â€” please double-check important info!</div>
    </footer>
  </main>
  <script>
    const app  = document.getElementById('app');
    const chat = document.getElementById('chat');
    const box  = document.getElementById('box');
    const sendBtn = document.getElementById('send');
    const statusEl = document.getElementById('status');
    const themeToggle = document.getElementById('themeToggle');
    const langHint = document.getElementById('langHint');

    // Theme
    const THEME_KEY = 'task_theme';
    function setTheme(t){
      document.documentElement.setAttribute('data-theme', t);
      localStorage.setItem(THEME_KEY, t);
      themeToggle.textContent = t === 'dark' ? 'â˜¾' : 'â˜¼';
    }
    setTheme(localStorage.getItem(THEME_KEY) || 'light');
    themeToggle.addEventListener('click', ()=> setTheme(
      (document.documentElement.getAttribute('data-theme')==='dark') ? 'light' : 'dark'
    ));

    // ------- helpers -------
    function addUser(text){
      const el = document.createElement('div');
      el.className = 'bubble user';
      el.textContent = text;
      chat.appendChild(el);
      chat.scrollTop = chat.scrollHeight;
    }
    function addBot(html){
      const el = document.createElement('div');
      el.className = 'bubble bot';
      el.innerHTML = html;
      chat.appendChild(el);
      chat.scrollTop = chat.scrollHeight;
    }
    function typing(on=true){
      const id='typing';
      if(on){
        const el=document.createElement('div');
        el.id=id; el.className='bubble bot';
        el.innerHTML = `
          <div class="typing" aria-label="Assistant is typing">
            <span class="dot"></span><span class="dot"></span><span class="dot"></span>
          </div>`;
        chat.appendChild(el);
      }else{
        const t=document.getElementById(id); if(t) t.remove();
      }
      chat.scrollTop = chat.scrollHeight;
    }

    // ------- Language detect + sticky session -------
    let currentLang = 'en';   // start in English
    function detectLang(t){
      t = t.toLowerCase();
      const es = /hola|necesito|trabajo|empleo|dÃ³nde|donde|horario|cuÃ¡ndo|cuando|hora|tel[eÃ©]fono|direcci[oÃ³]n|cita|servicios|comida|entrenamiento|entrenamientos/.test(t);
      const ht = /bonjou|bonswa|mwen|bezwen|travay|kote|ede|manje|krey[oÃ²]l|telef[oÃ²]n|adr[eÃ¨]s|randevou|s[eÃ¨]vis|fÃ²masyon/.test(t);
      return es ? 'es' : (ht ? 'ht' : 'en');
    }
    function maybeSwitchLang(userText){
      const lang = detectLang(userText);
      if (/\benglish\b/i.test(userText) || /\bingl[eÃ©]s\b/i.test(userText) || /\bangle\b/i.test(userText)){
        currentLang = 'en';
      } else if (lang !== 'en'){
        currentLang = lang;
      }
      langHint.textContent =
        currentLang==='es' ? 'Hablo inglÃ©s y espaÃ±ol (y KreyÃ²l)' :
        currentLang==='ht' ? 'M pale Angle, PanyÃ²l & KreyÃ²l' :
        'I speak English, EspaÃ±ol & KreyÃ²l';
    }

    // ------- Intent classification (includes profanity) -------
    function intent(text){
      const t=(' '+text.toLowerCase()+' ').replace(/[^\p{L}\p{N}\s]/gu,' ');
      const tests = [
        ['trainings', /(training|trainings|program|programs|class|classes|course|courses|certification|culinary|emilio|academy|sora|forklift|apprenticeship)\b|entrenamiento|entrenamientos|fÃ²masyon/],
        ['jobs', /(job|jobs|work|employment|hiring|hire|opening|openings|apply|application|position|positions)\b|empleo|empleos|trabajo|travay/],
        ['alerts', /(alert|alerts|notify|notification|subscribe|updates)|alertas/],
        ['resume', /(resume|curriculum|currÃ­culum|cv|cover\s*letter)/],
        ['interview', /(interview|interview\s*tips|mock\s*interview|practice\s*interview)/],
        ['appointments', /(appointment|appointments|schedule|book|meeting|register|sign\s*up|rsvp|cita|programar|randevou)/],
        ['hours', /(hour|hours|time|when|open|close|lunch|dinner|meal|eat|food|hora|horario|almuerzo|cena|manje)/],
        ['location', /(where|address|location|directions|map|parking|d[oÃ³]nde|direcci[oÃ³]n|ubicaci[oÃ³]n|kote|adr[eÃ¨]s)/],
        ['transit', /(bus|nj\s*transit|route|fare|ticket|train|transport|planner)/],
        ['computer_lab', /(computer|internet|wifi|lab|email|application\s*online)/],
        ['resources', /(resource|resources|assistance|support\s*services|services\s*list|legal|benefits|housing)/],
        ['profanity', /\b(fuck|shit|bitch|asshole|bastard|dick|pussy|cunt|motherfucker|bullshit|wtf)\b/i],
        ['frustrated', /(this\s+is\s+(not|no)\s+help|useless|frustrat|mad|angry|annoyed|stupid|idiot)/],
        ['greeting', /^( *hi| *hello| *hey| *hola| *bonjou)[!. ]*$/i],
        ['thanks', /(thanks|thank you|gracias|mesi)/]
      ];
      for (const [k,rx] of tests){ if(rx.test(t)) return k; }
      return 'default';
    }

    // ------- Replies per language -------
    function t(key){
      const L = {
        en: {
          welcome: 'ğŸ‘‹ Welcome! Use keywords like <em>training</em>, <em>jobs</em>, <em>hours</em>, <em>address</em>, or <em>bus</em>.',
          quick: 'Quick links:',
          simple: 'Iâ€™ll keep it simple. Try â€œtrainingâ€, â€œjobsâ€, â€œhoursâ€, â€œaddressâ€, â€œappointmentâ€, or â€œbusâ€.',
          asked: 'You asked about',
          call: 'Call the Social Services Specialist at',
          during: 'During lunch (10:30 AMâ€“1:00 PM).',
          view: 'Browse training & apply',
          jobs_open: 'Open positions (Mercer County)',
          alerts: 'Subscribe to alerts',
          resume: 'Resume help & templates',
          tips: 'Watch quick tips',
          mealHours: 'Meals: Lunch Monâ€“Fri 10:30aâ€“1:00p â€¢ Dinner Monâ€“Thu 3:30â€“5:00p',
          address: '72Â½ Escher St, Trenton, NJ 08609',
          maps: 'Open Google Maps',
          bus: 'NJ Transit Trip Planner',
          more: 'Additional resources',
          allsvc: 'Full TASK services',
          thanks: 'ğŸ˜Š Youâ€™re welcome!',
          sorry: 'I hear you â€” this stuff can be stressful. Let me help fast:',
          talk: 'Call now',
          choices: 'Or pick one:',
          train: 'Training', jobs: 'Jobs', addr: 'Address',
          notFound: 'I might not have that yet. For more help, visit:',
          site_home: 'TASK website',
          site_services: 'What we do'
        },
        es: {
          welcome: 'ğŸ‘‹ Â¡Bienvenido! Usa palabras clave como <em>entrenamiento</em>, <em>empleos</em>, <em>horas</em>, <em>direcciÃ³n</em> o <em>autobÃºs</em>.',
          quick: 'Enlaces:',
          simple: 'Te lo hago simple. Prueba â€œentrenamientoâ€, â€œempleosâ€, â€œhorasâ€, â€œdirecciÃ³nâ€, â€œcitaâ€ o â€œautobÃºsâ€.',
          asked: 'Preguntaste sobre',
          call: 'Llama al Especialista de Servicios Sociales al',
          during: 'Durante el almuerzo (10:30 AMâ€“1:00 PM).',
          view: 'Ver entrenamientos y postular',
          jobs_open: 'Puestos disponibles (Condado de Mercer)',
          alerts: 'Suscribirme a alertas',
          resume: 'Ayuda con currÃ­culum y plantillas',
          tips: 'Ver consejos rÃ¡pidos',
          mealHours: 'Comidas: Almuerzo Lunâ€“Vie 10:30â€“1:00 â€¢ Cena Lunâ€“Jue 3:30â€“5:00',
          address: '72Â½ Escher St, Trenton, NJ 08609',
          maps: 'Abrir Google Maps',
          bus: 'Planificador de viaje de NJ Transit',
          more: 'Recursos adicionales',
          allsvc: 'Todos los servicios de TASK',
          thanks: 'ğŸ˜Š Â¡Con gusto!',
          sorry: 'Entiendo que esto puede ser frustrante. Te ayudo rÃ¡pido:',
          talk: 'Llamar ahora',
          choices: 'O elige:',
          train: 'Entrenamiento', jobs: 'Empleos', addr: 'DirecciÃ³n',
          notFound: 'Puede que aÃºn no tenga eso. Para mÃ¡s ayuda, visita:',
          site_home: 'Sitio de TASK',
          site_services: 'QuÃ© hacemos'
        },
        ht: {
          welcome: 'ğŸ‘‹ Byenvini! Itilize mo tankou <em>fÃ²masyon</em>, <em>travay</em>, <em>lÃ¨</em>, <em>adrÃ¨s</em>, oswa <em>otobis</em>.',
          quick: 'Lyen rapid:',
          simple: 'Ann fÃ¨ li senp. Eseye â€œfÃ²masyonâ€, â€œtravayâ€, â€œlÃ¨â€, â€œadrÃ¨sâ€, â€œrandevouâ€, oswa â€œotobisâ€.',
          asked: 'Ou te mande sou',
          call: 'Rele Espesyalis SÃ¨vis Sosyal la nan',
          during: 'Pandan manje midi (10:30 AMâ€“1:00 PM).',
          view: 'Gade fÃ²masyon & aplike',
          jobs_open: 'Travay ki disponib (Mercer County)',
          alerts: 'AbÃ²nman ak alÃ¨t',
          resume: 'Ede ak CV & modÃ¨l',
          tips: 'Gade konsÃ¨y rapid yo',
          mealHours: 'Manje: Madiâ€“Vandredi 10:30â€“1:00 â€¢ AswÃ¨ Lendiâ€“Jedi 3:30â€“5:00',
          address: '72Â½ Escher St, Trenton, NJ 08609',
          maps: 'Louvri Google Maps',
          bus: 'PlanifikatÃ¨ vwayaj NJ Transit',
          more: 'Resous adisyonÃ¨l',
          allsvc: 'Tout sÃ¨vis TASK yo',
          thanks: 'ğŸ˜Š Pa gen pwoblÃ¨m!',
          sorry: 'M konprann sa ka fristre. Ann regle sa rapid:',
          talk: 'Rele kounye a',
          choices: 'Oswa chwazi youn:',
          train: 'FÃ²masyon', jobs: 'Travay', addr: 'AdrÃ¨s',
          notFound: 'M pa ka reponn egzakteman sa a kounye a. Pou plis Ã¨d, vizite:',
          site_home: 'Sit wÃ¨b TASK',
          site_services: 'Sa n ap fÃ¨'
        }
      };
      return L[currentLang][key];
    }

    function respond(intentKey){
      const phone = '<a href="tel:609-337-1624">(609) 337-1624</a>';
      const M = {
        trainings: () => `<strong>ğŸ“ ${t('asked')} training.</strong><br><br>
          â€¢ Emilio Culinary Academy (10-week)<br>
          â€¢ SORA Security Certification<br>
          â€¢ Forklift Certification<br><br>
          <a href="https://bycell.co/ddmtn" target="_blank" rel="noopener">${t('view')}</a><br>
          ${t('call')} ${phone}. ${t('during')}.`,
        jobs: () => `<strong>ğŸ’¼ ${t('asked')} jobs.</strong><br><br>
          <a href="https://bycell.co/ddmtq" target="_blank" rel="noopener">${t('jobs_open')}</a><br>
          <a href="https://bycell.co/ddmtr" target="_blank" rel="noopener">${t('alerts')}</a><br><br>
          ${t('call')} ${phone}. ${t('during')}.`,
        alerts: () => `<strong>ğŸ”” ${t('asked')} alerts.</strong><br><br>
          <a href="https://bycell.co/ddmtr" target="_blank" rel="noopener">${t('alerts')}</a>`,
        resume: () => `<strong>ğŸ“„ ${t('asked')} resume help.</strong><br><br>
          <a href="https://bycell.co/ddmui" target="_blank" rel="noopener">${t('resume')}</a><br><br>
          ${t('call')} ${phone}. ${t('during')}.`,
        interview: () => `<strong>ğŸ¥ ${t('asked')} interview tips.</strong><br><br>
          <a href="https://www.youtube.com/watch?v=ZU9x1vFx5lI" target="_blank" rel="noopener">${t('tips')}</a>`,
        appointments: () => `<strong>ğŸ“… ${t('asked')} an appointment.</strong><br><br>
          ${t('call')} ${phone}. ${t('during')}.`,
        hours: () => `<strong>ğŸ•’ ${t('asked')} hours.</strong><br><br>${t('mealHours')}`,
        location: () => `<strong>ğŸ“ ${t('asked')} our location.</strong><br><br>
          ${t('address')}<br>
          <a href="https://www.google.com/maps?q=72+1/2+Escher+St,+Trenton,+NJ+08609" target="_blank" rel="noopener">${t('maps')}</a>`,
        transit: () => `<strong>ğŸšŒ ${t('asked')} transit.</strong><br><br>
          <a href="https://www.njtransit.com/trip-planner-to" target="_blank" rel="noopener">${t('bus')}</a> â€¢ 1-973-275-5555<br>
          Destination: 72Â½ Escher St, Trenton.`,
        computer_lab: () => `<strong>ğŸ’» ${t('asked')} the computer lab.</strong><br><br>
          Open during meal hours. Free internet & job applications.`,
        resources: () => `<strong>ğŸ§° ${t('asked')} resources.</strong><br><br>
          <a href="https://bycell.co/ddmua" target="_blank" rel="noopener">${t('more')}</a><br>
          <a href="https://trentonsoupkitchen.org/what-we-do/" target="_blank" rel="noopener">${t('allsvc')}</a>`,
        profanity: () => `<strong>ğŸ™ ${t('sorry')}</strong><br><br>
          ${t('talk')}: <a href="tel:609-337-1624">(609) 337-1624</a><br><br>
          ${t('choices')} <a href="https://bycell.co/ddmtn" target="_blank" rel="noopener">${t('train')}</a> Â·
          <a href="https://bycell.co/ddmtq" target="_blank" rel="noopener">${t('jobs')}</a> Â·
          <a href="https://www.google.com/maps?q=72+1/2+Escher+St,+Trenton,+NJ+08609" target="_blank" rel="noopener">${t('addr')}</a>`,
        frustrated: () => `<strong>ğŸ™ ${t('sorry')}</strong><br><br>
          ${t('talk')}: <a href="tel:609-337-1624">(609) 337-1624</a><br><br>
          ${t('choices')} <a href="https://bycell.co/ddmtn" target="_blank" rel="noopener">${t('train')}</a> Â·
          <a href="https://bycell.co/ddmtq" target="_blank" rel="noopener">${t('jobs')}</a> Â·
          <a href="https://www.google.com/maps?q=72+1/2+Escher+St,+Trenton,+NJ+08609" target="_blank" rel="noopener">${t('addr')}</a>`,
        greeting: () => `ğŸ‘‹ ${t('simple')}`,

        /* NEW: if input isn't part of the keywords (default), direct to both website links */
        default: () => `<strong>ğŸ”— ${t('notFound')}</strong><br>
          <a href="https://trentonsoupkitchen.org/" target="_blank" rel="noopener">${t('site_home')}</a> â€¢
          <a href="https://trentonsoupkitchen.org/what-we-do/" target="_blank" rel="noopener">${t('site_services')}</a>`
      };
      return (M[intentKey] || M.default)();
    }

    function send(){
      const text = (box.value || '').trim();
      if(!text) return;
      addUser(text);
      box.value = ''; box.focus();
      statusEl.textContent = 'ğŸ¤– Thinkingâ€¦';
      maybeSwitchLang(text);
      typing(true);
      setTimeout(()=>{
        typing(false);
        addBot(respond(intent(text)));
        statusEl.textContent = 'âœ… Answered!';
        setTimeout(()=> statusEl.textContent = 'âš ï¸ I can make mistakes â€” please double-check important info!', 1200);
      }, 260);
    }

    // Initial welcome
    addBot(`ğŸŸ¡ <strong>${t('welcome')}</strong><br><br>
            ${t('quick')} <a href="https://bycell.co/ddmtn" target="_blank" rel="noopener">Training</a> â€¢
            <a href="https://bycell.co/ddmtq" target="_blank" rel="noopener">Jobs</a> â€¢
            <a href="https://bycell.co/ddmtr" target="_blank" rel="noopener">Alerts</a>`);

    // Events
    sendBtn.addEventListener('click', send);
    box.addEventListener('keydown', e=>{ if(e.key==='Enter'){ e.preventDefault(); send(); } });
    document.getElementById('top-rail').addEventListener('click', e=>{
      const a = e.target.closest('a'); if(!a) return;
      // open link; no chat message
    });
  </script>
</body>
</html>
